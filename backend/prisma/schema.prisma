// prisma/schema.prisma
datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id           Int      @id @default(autoincrement())
  email        String   @unique
  name         String?  // 선택
  passwordHash String   // 해시만 저장
  role         String?  // 선택
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}
// prisma/schema.prisma
// ──────────────────────────────────────────────────────────────────────────────
// 이 파일은 **Prisma 스키마**입니다.
//
// Prisma = 타입 안전 ORM. 이 스키마로 아래를 수행합니다:
//  1) **DB 스키마 정의**(모델/관계/인덱스 등)
//  2) `@prisma/client` **타입 안전 클라이언트 코드 생성** (generator 블록)
//  3) **마이그레이션 관리** (`prisma migrate` / `db push`)
//
// 블록 구성 요약
//  - `datasource`: 어떤 DB에 어떤 드라이버로 연결할지와 연결 URL을 정의합니다.
//                  URL은 일반적으로 `.env`의 `DATABASE_URL`에서 불러옵니다.
//  - `generator`: Prisma가 생성할 클라이언트를 정의합니다. (JS/TS에서 import하여 사용)
//  - `model`: 실제 테이블 정의(여기서는 `User`). 각 필드는 타입/제약조건을 가집니다.
//
// 개발(로컬)에서는 **SQLite**를 쓰고, 운영(AWS RDS)으로 전환 시 **PostgreSQL 또는 MySQL**로
// 갈아탈 수 있도록 작성되어 있습니다. 전환 시에는 provider와 DATABASE_URL만 바꾸면 됩니다.
// ──────────────────────────────────────────────────────────────────────────────

datasource db {
  // [개발] 현재 SQLite 사용
  //   - .env 예시: DATABASE_URL="file:./prisma/dev.db"
  // [운영 전환(AWS RDS)] 아래 provider / DATABASE_URL만 교체하세요.
  //   - PostgreSQL: provider = "postgresql"
  //     .env 예시:
  //       DATABASE_URL="postgresql://USER:PASSWORD@HOST:5432/DB?schema=public&amp;sslmode=require"
  //   - MySQL/MariaDB: provider = "mysql"
  //     .env 예시:
  //       DATABASE_URL="mysql://USER:PASSWORD@HOST:3306/DB?sslaccept=strict"
  //
  // ✅ 전환 절차(요약)
  //   1) RDS 인스턴스 생성(Aurora/PostgreSQL/MySQL) → 엔드포인트/포트/DB명 확인
  //   2) `.env`의 `DATABASE_URL`을 RDS 정보로 교체
  //   3) `provider`를 RDS 종류에 맞게 변경
  //   4) 마이그레이션/스키마 반영
  //      - 개발/스테이징:   `npx prisma migrate dev --name init-rds`
  //      - 운영 배포(CI):   `npx prisma migrate deploy`
  //      - 클라이언트 갱신: `npx prisma generate`
  //   5) 보안
  //      - RDS 보안그룹에 앱서버 IP 허용
  //      - DB 암호/비밀값은 .env 또는 AWS SSM/Secrets Manager로 관리
  //      - 연결 수요가 큰 경우, pgbouncer(Aurora) 또는 Prisma Accelerate 등 풀링 고려
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  // Prisma 클라이언트 생성 설정입니다.
  // TS/JS 코드에서: `import { PrismaClient } from '@prisma/client'`
  // 그런 다음 `const prisma = new PrismaClient()`로 쿼리 수행
  provider = "prisma-client-js"
}

model User {
  // 기본 키: 자동 증가 정수
  id           Int      @id @default(autoincrement())

  // 이메일: 유일해야 함(로그인 키)
  email        String   @unique

  // 표시 이름: 선택(optional)
  name         String?  // 선택

  // 비밀번호 해시만 저장(예: bcrypt 해시). 평문 비밀번호 저장 금지!
  passwordHash String

  // 권한/역할: 선택(optional), 예: "user" | "admin"
  role         String?  // 선택

  // 생성/수정 시각
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}